"use strict";(self["webpackChunkcourse"]=self["webpackChunkcourse"]||[]).push([[245],{2233:function(e,t,a){a.d(t,{AG:function(){return l},gK:function(){return r},jO:function(){return m},n:function(){return s},oJ:function(){return i},s7:function(){return o}});var n=a(5720);function r(e){return(0,n.A)({url:"/admin/class",method:"post",data:e})}function o(){return(0,n.A)({url:"/admin/class/names",method:"get"})}function s(e,t=1){return(0,n.A)({url:"/admin/class/page/"+t,method:"get",params:e})}function l(e){return(0,n.A)({url:"/admin/class/page/count",method:"get",params:e})}function i(e){return(0,n.A)({url:"/admin/class/"+e,method:"delete"})}function m(e){return(0,n.A)({url:"/admin/class",method:"put",data:e})}},2245:function(e,t,a){a.r(t),a.d(t,{default:function(){return b}});var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-container"},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("div",{staticStyle:{width:"100px"}},[t("el-button",{on:{click:e.showAdd}},[t("li",{staticClass:"el-icon-plus"},[e._v("创建")])])],1),t("div",{staticStyle:{display:"flex",width:"400px"}},[t("el-input",{attrs:{placeholder:"班级名"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),t("el-input",{attrs:{placeholder:"系名"},model:{value:e.departmentName,callback:function(t){e.departmentName=t},expression:"departmentName"}}),t("el-input",{attrs:{placeholder:"专业名"},model:{value:e.majorName,callback:function(t){e.majorName=t},expression:"majorName"}}),t("el-button",{attrs:{type:"primary"},on:{click:e.gettable}},[t("li",{staticClass:"el-icon-search"}),e._v(" 查询 ")])],1)]),t("div",{staticClass:"table-wrapper"},[t("div",{staticClass:"text item"},[t("el-table",{attrs:{data:e.tableData}},[t("el-table-column",{attrs:{label:"班级名"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.name))])]}}])}),t("el-table-column",{attrs:{label:"系名"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.departmentName))])]}}])}),t("el-table-column",{attrs:{label:"专业名"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.majorName))])]}}])}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.bianji(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.row.id)}}},[e._v("删除")])]}}])})],1)],1)])]),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.page,total:e.totalpage},on:{"current-change":e.handlePageChange}})],1),t("el-dialog",{attrs:{title:"添加",visible:e.dialogFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[t("banji",{key:e.dialogFormVisible,attrs:{form1:e.form},on:{close:e.handleClose}})],1)],1)},r=[],o=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",rules:e.rules}},[t("el-form-item",{attrs:{prop:"name",label:"班级名"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{prop:"grade",label:"年级"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.grade,callback:function(t){e.$set(e.form,"grade",t)},expression:"form.grade"}})],1),t("el-form-item",{attrs:{prop:"majorId",label:"所属专业"}},[t("el-select",{attrs:{placeholder:"请选择专业"},model:{value:e.form.majorId,callback:function(t){e.$set(e.form,"majorId",t)},expression:"form.majorId"}},e._l(e.departments,function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),t("el-form-item",[t("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确定")]),t("el-button",{on:{click:e.canel}},[e._v("取消")])],1)])],1)],1)},s=[],l=(a(8111),a(2489),a(2233)),i=a(8298),m={props:["form1"],data(){return{form:{id:this.form1.id,name:this.form1.name,grade:this.form1.grade,majorId:""},departments:[],rules:{name:[{required:!0,message:"请输入班级名",trigger:"blur"}],grade:[{required:!0,message:"请选择年级",trigger:"blur"}],majorId:[{required:!0,message:"请选择专业",trigger:"change"}]}}},methods:{getcalssName(){(0,i.hU)().then(e=>{console.log(e),console.log(this.form1),this.departments=e.data,this.form1.majorName&&e.data.filter(e=>{e.name==this.form1.majorName&&(this.form.majorId=e.id)})}).catch(e=>{})},submit(){this.$refs["form"].validate(e=>{console.log(e),e&&(-1==this.form1.id?(0,l.gK)(this.form).then(e=>{console.log(e),0===e.code&&(this.$message({type:"success",message:"添加成功"}),this.$emit("close"))}):(0,l.jO)(this.form).then(e=>{console.log(e),0===e.code&&(this.$message({type:"success",message:"更新成功"}),this.$emit("close"))}).catch(e=>{}))})},canel(){this.$emit("close")}},mounted(){this.getcalssName()}},u=m,c=a(1656),d=(0,c.A)(u,o,s,!1,null,null,null),f=d.exports,h={components:{banji:f},data(){return{name:"",majorName:"",departmentName:"",tableData:[],dialogFormVisible:!1,totalpage:1,page:1,form:{id:-1,majorName:"",grade:"",name:""}}},methods:{showAdd(){this.form.id=-1,this.form.name="",this.form.grade="",this.form.majorName="",this.dialogFormVisible=!0},handleClose(){this.fenyeZongshu(),this.gettable(),this.dialogFormVisible=!1},bianji(e){this.form.id=e.id,this.form.name=e.name,this.form.grade=e.grade,this.form.majorName=e.majorName,this.dialogFormVisible=!0},gettable(){let e={name:this.name,departmentName:this.departmentName,majorName:this.majorName};this.fenyeZongshu(),(0,l.n)(e,this.page).then(e=>{this.tableData=e.data}).catch(e=>{console.log(e)})},handlePageChange(e){this.page=e,this.gettable()},fenyeZongshu(){let e={name:this.name,departmentName:this.departmentName,majorName:this.majorName};(0,l.AG)(e).then(e=>{this.totalpage=10*e.data})},handleDelete(e){this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(()=>{(0,l.oJ)(e).then(e=>{0===e.code&&(this.$message({type:"success",message:"删除成功!"}),this.gettable())})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}},mounted(){this.gettable(),this.fenyeZongshu()}},p=h,g=(0,c.A)(p,n,r,!1,null,"4a4981b6",null),b=g.exports},8298:function(e,t,a){a.d(t,{AE:function(){return o},Fc:function(){return r},Ms:function(){return l},hU:function(){return i},l5:function(){return m},pY:function(){return s}});var n=a(5720);function r(e){return(0,n.A)({url:"/admin/major",method:"post",data:e})}function o(e,t=1){return(0,n.A)({url:"/admin/major/page/"+t,method:"get",params:e})}function s(e){return(0,n.A)({url:"/admin/major/page/count",method:"get",params:e})}function l(e){return(0,n.A)({url:"/admin/major",method:"put",data:e})}function i(){return(0,n.A)({url:"/admin/major/names",method:"get"})}function m(e){return(0,n.A)({url:"/admin/major/"+e,method:"delete"})}}}]);
//# sourceMappingURL=245.5fa2835d.js.map